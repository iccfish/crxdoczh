<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="static/css/site.css" rel="stylesheet" type="text/css">
    <link href="static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href="//www.google.com/images/icons/product/chrome-16.png" rel="icon" type="image/ico">
    <title>后台网页 - Google Chrome</title>
  </head>
  <body>
    <a id="top"></a>
    <div id="header">
      <span id="logo">
        <a href="http://code.google.com/"><img src="static/images/chrome_logo.gif" alt="Google Code Labs"></a>
      </span>
      <span id="cse">
        <gcse:searchbox-only enableAutoComplete="true" autoCompleteMatchTyple="prefix"></gcse:searchbox-only>
      </span>
    </div>
    <a id="gc-topnav-anchor"></a>
    <div id="gc-topnav">
      <h1>Google Chrome 扩展程序（非官方中文版）</h1>
      <ul id="home" class="gc-topnav-tabs">
        <li id="home_link">
          <!--@<a href="index.html" title="Google Chrome 扩展程序 home page"><div>Home</div></a>-->
          <a href="index.html" title="Google Chrome 扩展程序主页"><div>主页</div></a>
        </li>
        <li id="docs_link">
          <!--@<a href="docs.html" title="Official Google Chrome 扩展程序 documentation"><div>Docs</div></a>-->
          <a href="docs.html" title="Google Chrome 扩展程序文档"><div>文档</div></a>
        </li>
        <li id="faq_link">
          <!--@<a href="faq.html" title="Answers to frequently asked questions about Google Chrome 扩展程序"><div>FAQ</div></a>-->
          <a href="faq.html" title="关于 Google Chrome 扩展程序常见问题的答案"><div>常见问题</div></a>
        </li>
        <li id="samples_link">
          <!--@<a href="samples.html" title="Sample 扩展程序 (with source code)"><div>Samples</div></a>-->
          <a href="samples.html" title="示例扩展程序（包含源代码）"><div>示例</div></a>
        </li>
        <li id="group_link">
          <!--<a href="http://groups.google.com/a/chromium.org/group/chromium-extensions" title="Google Chrome 扩展程序 developer forum"><div>Group</div></a>-->
          <a href="http://groups.google.com/a/chromium.org/group/chromium-extensions" title="Google Chrome 扩展程序开发人员论坛"><div>论坛（英文）</div></a>
        </li>
        <li id="so_link">
          <!--<a href="http://stackoverflow.com/questions/tagged/google-chrome-extension" title="[google-chrome-extension] tag on Stack Overflow"><div>Questions?</div></a>-->
          <a href="http://stackoverflow.com/questions/tagged/google-chrome-extension" title="Stack Overflow 上的 [google-chrome-extension] 标签"><div>问题？（英文）</div></a>
        </li>
      </ul>
    </div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <ul 
            class="level1 ">
          <li class="level2">
                <a href="getstarted.html" class="level2 ">入门</a>
          </li>
          <li class="level2">
                <a href="overview.html" class="level2 ">概述</a>
          </li>
          <li class="level2">
                <a href="whats_new.html" class="level2 ">新增功能</a>
          </li>
          <li class="level2">
                <a href="devguide.html" class="level2 "></a>
              <ul 
                  class="level2 ">
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">浏览器用户界面</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="browserAction.html" class="level4 ">浏览器按钮</a>
                      </li>
                      <li class="level4">
                            <a href="contextMenus.html" class="level4 ">右键菜单</a>
                      </li>
                      <li class="level4">
                            <a href="notifications.html" class="level4 ">桌面通知</a>
                      </li>
                      <li class="level4">
                            <a href="omnibox.html" class="level4 ">多功能框</a>
                      </li>
                      <li class="level4">
                            <a href="options.html" class="level4 ">选项页面</a>
                      </li>
                      <li class="level4">
                            <a href="override.html" class="level4 ">替代页面</a>
                      </li>
                      <li class="level4">
                            <a href="pageAction.html" class="level4 ">页面按钮</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">浏览器交互</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="bookmarks.html" class="level4 ">书签</a>
                      </li>
                      <li class="level4">
                            <a href="cookies.html" class="level4 ">Cookie</a>
                      </li>
                      <li class="level4">
                            <a href="devtools.html" class="level4 ">开发者工具</a>
                      </li>
                      <li class="level4">
                            <a href="events.html" class="level4 ">事件</a>
                      </li>
                      <li class="level4">
                            <a href="history.html" class="level4 ">历史记录</a>
                      </li>
                      <li class="level4">
                            <a href="management.html" class="level4 ">管理</a>
                      </li>
                      <li class="level4">
                            <a href="tabs.html" class="level4 ">标签页</a>
                      </li>
                      <li class="level4">
                            <a href="windows.html" class="level4 ">窗口</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">实现</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="a11y.html" class="level4 ">辅助功能</a>
                      </li>
                      <li class="level4">
                            <a href="event_pages.html" class="level4 ">事件页面</a>
                      </li>
                      <li class="level4">
                            <a href="contentSecurityPolicy.html" class="level4 ">内容安全策略</a>
                      </li>
                      <li class="level4">
                            <a href="content_scripts.html" class="level4 ">内容脚本</a>
                      </li>
                      <li class="level4">
                            <a href="xhr.html" class="level4 ">跨站XHR</a>
                      </li>
                      <li class="level4">
                            <a href="i18n.html" class="level4 ">国际化支持</a>
                      </li>
                      <li class="level4">
                            <a href="messaging.html" class="level4 ">消息传递</a>
                      </li>
                      <li class="level4">
                            <a href="permissions.html" class="level4 ">可选权限</a>
                      </li>
                      <li class="level4">
                            <a href="npapi.html" class="level4 ">NPAPI 插件</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">完成</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="hosting.html" class="level4 ">托管</a>
                      </li>
                      <li class="level4">
                            <a href="external_extensions.html" class="level4 ">其他发布选项</a>
                      </li>
                    </ul>
                </li>
              </ul>
          </li>
          <li class="level2">
                <a href="tutorials.html" class="level2 ">教程</a>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="tut_migration_to_manifest_v2.html" class="level3 ">清单文件版本2</a>
                </li>
                <li class="level3">
                      <a href="tut_debugging.html" class="level3 ">调试</a>
                </li>
                <li class="level3">
                      <a href="tut_analytics.html" class="level3 ">Google Analytics（分析）</a>
                </li>
                <li class="level3">
                      <a href="tut_oauth.html" class="level3 ">OAuth</a>
                </li>
              </ul>
          </li>
          <li class="level2">
                <span class="level2">参考</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">格式</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="manifest.html" class="level4 ">清单文件</a>
                      </li>
                      <li class="level4">
                            <a href="match_patterns.html" class="level4 ">匹配表达式</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                      <a href="permission_warnings.html" class="level3 ">权限警告</a>
                </li>
                <li class="level3">
                      <a href="api_index.html" class="level3 ">chrome.* API</a>
                </li>
                <li class="level3">
                      <a href="api_other.html" class="level3 ">其他 API</a>
                </li>
              </ul>
          </li>
          <li class="level2">
                <span class="level2">更多</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="https://code.google.com/chrome/webstore/docs/index.html" class="level3 ">Chrome 网上应用店</a>
                </li>
                <li class="level3">
                      <a href="https://code.google.com/chrome/apps/docs/developers_guide.html" class="level3 ">托管应用程序</a>
                </li>
                <li class="level3">
                      <a href="themes.html" class="level3 ">主题背景</a>
                </li>
              </ul>
          </li>
        </ul>
      </div>
      <div id="gc-pagecontent">
        <h1 class="page_title">后台网页</h1>
        <div id="toc">
          <h2><!--@Contents-->目录</h2>
          <ol>
            <li>
              <a href=#manifest>清单文件</a>
            </li>
            <li>
              <a href=#details>详情</a>
            </li>
            <li>
              <a href=#example>例子</a>
            </li>
          </ol>
        </div>




<p id="eventPageWarning" class="warning">
  <em><!--@Caution:-->注意：</em><!--@ Consider using event pages instead.
  <a href="event_pages.html">Learn more</a>.-->
  考虑改用事件页面。<a href="event_pages.html">了解更多</a>
</p>

<p>
<!--@A common need for extensions is to have
a single long-running script to manage some task or state.
Background pages to the rescue.-->
扩展程序通常需要有一个长时间运行的脚本来管理一些任务或状态，而后台网页就是为这一目的而设立。
</p>

<p>
<!--@As the <a href="overview.html#arch">architecture overview</a> explains,
the background page is an HTML page that runs in the extension process.
It exists for the lifetime of your extension,
and only one instance of it at a time is active.-->
如<a href="overview.html#arch">架构概述</a>所述，后台网页是一个 HTML 页面，在扩展程序的进程中运行。它在您的扩展程序整个生命周期中都存在，并且一次只有一个活动的实例。
</p>

<p>
<!--@In a typical extension with a background page,
the UI &mdash;
for example, the browser action or page action
and any options page &mdash;
is implemented by dumb views.
When the view needs some state,
it requests the state from the background page.
When the background page notices a state change,
the background page tells the views to update.-->
在一个具有后台页面的典型扩展程序中，用户界面（例如浏览器按钮或页面按钮以及选项页面）通过哑视图（dumb view）实现，当视图需要某些状态时，则从后台页面请求状态；当后台页面得知状态更改时，后台页面通知相应的视图更新。
</p>

<h2 id="manifest"><!--@Manifest-->清单文件</h2>

<p>
<!--@Register your background page in the
<a href="manifest.html">extension manifest</a>.
In the common case, a background page
does not require any HTML markup.
These kind of background pages can be
implemented using JavaScript files alone,
like this:-->
请在<a href="manifest.html">扩展程序的清单文件</a>中注册您的后台页面。通常情况下，后台页面不需要任何 HTML 标记，这种情况下后台页面可以单独使用 JavaScript文件实现，如下列代码所示：
</p>

<pre>{
  "name": "我的扩展程序",
  ...
  <b>"background": {
    "scripts": ["background.js"]
  }</b>,
  ...
}</pre>

<p>
<!--@A background page will be generated
by the extension system
that includes each of the files listed
in the <code>scripts</code> property.-->
后台页面将由扩展程序系统生成，包含 <code>scripts</code>
属性中列出的每一个文件。
</p>

<p>
<!--@If you need to specify HTML
in your background page, you can
do that using the <code>page</code>
property instead:-->
如果您需要在您的后台页面中指定 HTML，您可以改用 <code>page</code> 属性：
</p>

<pre>{
  "name": "我的扩展程序",
  ...
  <b>"background": {
    "page": "background.html"
  }</b>,
  ...
}</pre>

<p>
<!--@If you need the browser to start up early&mdash;so
you can display notifications, for example&mdash;then
you might also want to specify the
<a href="manifest.html#permissions">"background" permission</a>.-->
如果您需要浏览器早些启动，例如显示通知，您可能还需要指定
<a href="declare_permissions.html">"background"</a> 权限。
</p>


<h2 id="details"><!--@Details-->详情</h2>

<p>
<!--@You can communicate between your various pages using direct script calls,
similar to how frames can communicate.
The <a href="extension.html#method-getViews">extension.getViews</a> method
returns a list of window objects
for every active page belonging to your extension,
and the
<a href="extension.html#method-getBackgroundPage">extension.getBackgroundPage</a> method
returns the background page.-->
您可以通过直接的脚本调用在不同页面间通信，类似于在框架间通信。<a href="extension.html#method-getViews">extension.getViews</a>
方法返回属于您的扩展程序的所有活动页面的 window 对象，而
<a href="extension.html#method-getBackgroundPage">extension.getBackgroundPage</a> 方法返回后台页面。
</p>

<h2 id="example"><!--@Example-->例子</h2>

<p>
<!--@The following code snippet demonstrates
how the background page
can interact with other pages in the extension.
It also shows how you can use
the background page to handle events
such as user clicks.-->
以下代码片段演示了后台页面是如何与扩展程序中的其它页面通信的，同时也演示了您应该如何使用后台页面处理诸如用户单击之类的事件。
</p>

<p>
<!--@The extension in this example
has a background page
and multiple pages created
(with
<a href="tabs.html#method-create">tabs.create</a>)
from a file named <code>image.html</code>.-->
这一例子中的扩展程序有一个后台页面和多个创建自
<code>image.html</code>
的页面（使用 <a href="tabs.html#method-create">tabs.create</a>）。

</p>

<pre>
<em>// 在 background.js 中：</em>
// 当浏览器按钮图标单击时作出反应。
chrome.browserAction.onClicked.addListener(function(tab) {
  var viewTabUrl = chrome.extension.getURL('image.html');
  var imageUrl = <em>/* 某个图片的 URL */</em>;

  // 查找扩展程序中的所有页面，找到我们可以使用的一个。
  var views = chrome.extension.getViews();
  for (var i = 0; i < views.length; i++) {
    var view = views[i];

    // 如果这一视图有正确的 URL 并且还未使用……
    if (view.location.href == viewTabUrl && !view.imageAlreadySet) {

      // ……调用其中一个函数并设置属性。
      view.setImageUrl(imageUrl);
      view.imageAlreadySet = true;
      break; // 完成
    }
  }
});
</pre>

<pre>
<em>&lt;!-- 在 image.html 中： --&gt;</em>
&lt;html&gt;
  &lt;script&gt;
    function setImageUrl(url) {
      document.getElementById('target').src = url;
    }
  &lt;/script&gt;

  &lt;body&gt;
    &lt;p&gt;
    Image here:
    &lt;/p&gt;

    &lt;img id="target" src="white.png" width="640" height="480">

  &lt;/body&gt;
&lt;/html&gt;
</pre>
      </div>
    </div>
  </body>
  <script>
    window.bootstrap = {
      api_names: [{"name":"alarms"},{"name":"bookmarks"},{"name":"browserAction"},{"name":"browsingData"},{"name":"commands"},{"name":"contentSettings"},{"name":"contextMenus"},{"name":"cookies"},{"name":"debugger"},{"name":"declarativeContent"},{"name":"declarativeWebRequest"},{"name":"devtools.inspectedWindow"},{"name":"devtools.network"},{"name":"devtools.panels"},{"name":"downloads"},{"name":"events"},{"name":"extension"},{"name":"fileBrowserHandler"},{"name":"fontSettings"},{"name":"history"},{"name":"i18n"},{"name":"idle"},{"name":"input.ime"},{"name":"management"},{"name":"omnibox"},{"name":"pageAction"},{"name":"pageCapture"},{"name":"permissions"},{"name":"privacy"},{"name":"proxy"},{"name":"pushMessaging"},{"name":"runtime"},{"name":"scriptBadge"},{"name":"sessionRestore"},{"name":"storage"},{"name":"tabCapture"},{"name":"tabs"},{"name":"topSites"},{"name":"tts"},{"name":"ttsEngine"},{"name":"types"},{"name":"webNavigation"},{"name":"webRequest"},{"name":"webstore"},{"last":true,"name":"windows"}].concat(
          [{"name":"experimental.devtools.audits"},{"name":"experimental.devtools.console"},{"name":"experimental.discovery"},{"name":"experimental.history"},{"name":"experimental.identity"},{"name":"experimental.infobars"},{"name":"experimental.processes"},{"name":"experimental.record"},{"name":"experimental.speechInput"},{"name":"experimental.systemInfo.cpu"},{"last":true,"name":"experimental.systemInfo.storage"}]),
      branchInfo: {"channels":[{"path":"stable","name":"Stable"},{"path":"dev","name":"Dev"},{"path":"beta","name":"Beta"},{"path":"trunk","name":"Trunk"}],"current":"stable","showWarning":false}
    };
  </script>
  <div id="gc-footer">
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        该页面翻译自
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        与
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>。除非特别<a href="https://code.google.com/policies.html#restrictions">说明</a>，该页面的内容遵循
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>，代码示例遵循
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>。
      </p>
      <p>
        <!--@©2012 Google-->
      </p>
      <script src="static/js/branch.js" type="text/javascript"></script>
      <script src="static/js/sidebar.js" type="text/javascript"></script>
      <script src="static/js/prettify.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++)
            preElements[i].classList.add('prettyprint');
          prettyPrint();
        })();
      </script>
      <script src="https://www.google-analytics.com/urchin.js" type="text/javascript"></script>
      <script src="https://www.google-analytics.com/ga.js" type="text/javascript"></script>
      <script type="text/javascript">
        // chrome doc tracking
        try {
          var engdocs = _gat._getTracker("YT-10763712-2");
          engdocs._trackPageview();
        } catch(err) {}
        // code.google.com site-wide tracking
        try {
          _uacct="UA-18071-1";
          _uanchor=1;
          _uff=0;
          urchinTracker();
        }
        catch(e) {/* urchinTracker not available. */}
      </script>
      <script>
        (function() {
          var cx = '002967670403910741006:61_cvzfqtno';
          var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
          gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
        })();
      </script>
  
    </div>
  </div>
</html>

