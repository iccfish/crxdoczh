<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="/trunk/static/css/site.css" rel="stylesheet" type="text/css">
    <link href="/trunk/static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="/trunk/static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href="//www.google.com/images/icons/product/chrome-16.png" rel="icon" type="image/ico">
    <title>Connect Apps with Web Intents - Google Chrome</title>
  </head>
  <body>
    <a id="top"></a>
    <div id="header">
      <span id="logo">
        <a href="http://code.google.com/" id="view-original"><img src="/trunk/static/images/chrome_logo.gif" alt="单击此处查看英文原文"></a>
        <script type="text/javascript">
          document.getElementById('view-original').href = "https://developer.chrome.com" + location.pathname;
        </script>
      </span>
      <span id="cse">
        <gcse:searchbox-only enableAutoComplete="true" autoCompleteMatchTyple="prefix"></gcse:searchbox-only>
      </span>
    </div>
    <a id="gc-topnav-anchor"></a>
    <div id="gc-topnav">
      <h1>Google Chrome 应用（非官方中文版）</h1>
      <ul id="home" class="gc-topnav-tabs">
        <li id="home_link">
          <!--@<a href="index.html" title="Google Chrome 应用 home page"><div>Home</div></a>-->
          <a href="index.html" title="Google Chrome 应用主页"><div>主页</div></a>
        </li>
        <li id="docs_link">
          <!--@<a href="docs.html" title="Official Google Chrome 应用 documentation"><div>Docs</div></a>-->
          <a href="docs.html" title="Google Chrome 应用文档"><div>文档</div></a>
        </li>
        <li id="faq_link">
          <!--@<a href="faq.html" title="Answers to frequently asked questions about Google Chrome 应用"><div>FAQ</div></a>-->
          <a href="faq.html" title="关于 Google Chrome 应用常见问题的答案"><div>常见问题</div></a>
        </li>
        <li id="samples_link">
          <!--@<a href="samples.html" title="Sample 应用 (with source code)"><div>Samples</div></a>-->
          <a href="samples.html" title="示例应用（包含源代码）"><div>示例</div></a>
        </li>
        <li id="group_link">
          <!--<a href="http://groups.google.com/a/chromium.org/group/chromium-extensions" title="Google Chrome 应用 developer forum"><div>Group</div></a>-->
          <a href="http://groups.google.com/a/chromium.org/group/chromium-extensions" title="Google Chrome 应用开发人员论坛"><div>论坛（英文）</div></a>
        </li>
        <li id="so_link">
          <!--<a href="http://stackoverflow.com/questions/tagged/google-chrome-extension" title="[google-chrome-extension] tag on Stack Overflow"><div>Questions?</div></a>-->
          <a href="http://stackoverflow.com/questions/tagged/google-chrome-extension" title="Stack Overflow 上的 [google-chrome-extension] 标签"><div>问题？（英文）</div></a>
        </li>
      </ul>
    </div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <ul 
            class="level1 ">
          <li class="level2">
                <span class="level2">入门</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="about_apps.html" class="level3 ">什么是打包应用？</a>
                </li>
                <li class="level3">
                      <a href="app_architecture.html" class="level3 ">理解架构</a>
                </li>
                <li class="level3">
                      <a href="first_app.html" class="level3 ">创建您的第一个应用</a>
                </li>
              </ul>
          </li>
          <li class="level2">
                <span class="level2">开发</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="develop_apps.html" class="level3 ">在您开始之前</a>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">基础知识</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="app_lifecycle.html" class="level4 ">Manage App Lifecycle</a>
                      </li>
                      <li class="level4">
                            <a href="app_storage.html" class="level4 ">Manage Data</a>
                      </li>
                      <li class="level4">
                            <a href="offline_apps.html" class="level4 ">首先考虑离线</a>
                      </li>
                      <li class="level4">
                            <a href="app_external.html" class="level4 ">嵌入内容</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">安全和隐私权</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="app_identity.html" class="level4 ">Identify User</a>
                      </li>
                      <li class="level4">
                            <a href="app_csp.html" class="level4 ">Comply with CSP</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">通知</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                          <a class="button level4">
                            <span class="level4">云消息服务</span>
                            <div class="toggleIndicator level4"></div>
                          </a>
                          <ul toggleable
                              class="level4 hidden">
                            <li class="level5">
                                  <a href="cloudMessaging.html" class="level5 ">关于云消息服务</a>
                            </li>
                            <li class="level5">
                                  <a href="pushMessaging.html" class="level5 ">客户端参考</a>
                            </li>
                            <li class="level5">
                                  <a href="gcm_server.html" class="level5 ">服务参考</a>
                            </li>
                            <li class="level5">
                                  <a href="gcm_tos.html" class="level5 ">服务条款</a>
                            </li>
                          </ul>
                      </li>
                      <li class="level4">
                            <a href="notifications.html" class="level4 ">桌面通知</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">高级技术</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="app_network.html" class="level4 ">Network Communications</a>
                      </li>
                      <li class="level4">
                            <a href="app_hardware.html" class="level4 ">Access Hardware Devices</a>
                      </li>
                    </ul>
                </li>
                <li class="level3">
                    <a class="button level3">
                      <span class="level3">MVC 架构</span>
                      <div class="toggleIndicator level3"></div>
                    </a>
                    <ul toggleable
                        class="level3 hidden">
                      <li class="level4">
                            <a href="app_frameworks.html" class="level4 ">关于 MVC 架构</a>
                      </li>
                      <li class="level4">
                            <a href="angular_framework.html" class="level4 ">用 AngularJS 建立应用</a>
                      </li>
                      <li class="level4">
                            <a href="sencha_framework.html" class="level4 ">Build Apps with Sencha Ext JS</a>
                      </li>
                    </ul>
                </li>
              </ul>
          </li>
          <li class="level2">
                <span class="level2">部署</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="publish_app.html" class="level3 ">发布</a>
                </li>
              </ul>
          </li>
          <li class="level2">
                <span class="level2">参考</span>
              <ul 
                  class="level2 ">
                <li class="level3">
                      <a href="manifest.html" class="level3 ">清单文件</a>
                </li>
                <li class="level3">
                      <a href="api_index.html" class="level3 ">Chrome 浏览器的 JavaScript API</a>
                </li>
                <li class="level3">
                      <a href="api_other.html" class="level3 ">支持的库</a>
                </li>
                <li class="level3">
                      <a href="app_deprecated.html" class="level3 ">禁用的网页特性</a>
                </li>
              </ul>
          </li>
          <li class="level2">
                <a href="samples.html" class="level2 ">示例</a>
          </li>
          <li class="level2">
                <a href="app_known_issues.html" class="level2 ">Known Issues</a>
          </li>
        </ul>
      </div>
      <div id="gc-pagecontent">
        <h1 class="page_title">Connect Apps with Web Intents</h1>
        <div id="toc">
          <h2><!--@Contents-->目录</h2>
          <ol>
            <li>
              <a href=#register>Register your app to handle an action</a>
            </li>
            <li>
              <a href=#content>Handling content types</a>
            </li>
            <li>
              <a href=#launching>Launching an app with a file</a>
            </li>
            <li>
              <a href=#launching>Manipulating the file</a>
            </li>
            <li>
              <a href=#return>Returning data to calling application</a>
            </li>
            <li>
              <a href=#localize>Localizing your app title</a>
            </li>
            <li>
              <a href=#invoke>Invoking an action</a>
            </li>
            <li>
              <a href=#errors>Handling Errors and Exceptions</a>
              <ol>
                <li><a href=#client>Client</a></li><li><a href=#service>Service</a></li>
              </ol>
            </li>
          </ol>
        </div>




<p>
<a href="http://webintents.org/">Web Intents</a>
allow your application to quickly communicate
with other applications on the user's system and inside their browser.
Your application can register to handle specific user actions
such as editing images via the <code>manifest.json</code>;
your application can also invoke actions to be handled by other applications.
</p>

<p>Pacakged apps use Web Intents as their primary mechanism for inter-app 
communication.</p>

<p class="note">
<b>API Samples: </b>
Want to play with the code?
Check out the
<a href="https://github.com/GoogleChrome/chrome-app-samples/tree/master/webintents">webintents</a> sample.
</p>

<h2 id="register">Register your app to handle an action</h2>

<p>
You must supply the intent in the manifest:
</p>

<pre>
"intents":{
 "http://webintents.org/edit" : [{
   "title" : "Best Image editing app",
   "type" : ["image/*"]
 }]
}
</pre>

<p>
Unlike extensions and hosted apps, packaged applications do not 
need a "href" attribute in the manifest declaration, this is 
because packaged apps have a single entry point for 
launch - the <code>onLaunched</code> event.  
</p>

<h2 id="content">Handling content types</h2>

<p>
Your application can be the user's preferred choice for handling a file type.
For example, your application could handle viewing images or viewing pdfs.
You must supply the intent in the manifest
and use the "http://webintents.org/view" action:
</p>
<p>To be able declare your application's ability to view RSS and ATOM 
feeds, you would add the following to your manifest.
</p>
<pre>
"intents": {
 "http://webintents.org/view" : [{
   "title" : "RSS Feed Reader",
   "type" : ["application/atom+xml", "application/rss+xml"]
 }]
}
</pre>

<p>
Your application will receive intent payload through the <code>onLaunched</code> event.
</p>
<pre>
chrome.app.runtime.onLaunched(function(intent) {
  // App Launched
  if(intent.action == "http://webinents.org/view" &amp;&amp;
     intent.type == "application/atom+xml") {

    // obtain the ATOM feed data.
    var data = intent.data;
  }
});
</pre>


<h2 id="launching">Launching an app with a file</h2>
<p>
If your app handles the <code>view</code> intent,
it is possible to launch it from the command line with a file as a parameter.
</p>
<pre>
chrome.exe --app-id [app_id] [path_to_file]
</pre>
<p>
This will implicity launch your application with an intent payload populated
with the action set to "http://webintents.org/view", the type set to the 
mime-type of the file and the data as a <code>FileEntry</code> object.
</p>
<pre>
chrome.app.runtime.onLaunched(function(intent) {
  // App Launched
  var data = intent.data;
});
</pre>

<h2 id="launching">Manipulating the file</h2>
<p>
  When your application is launched with a file as the parameter
  on the command-line,
  the <code>intent.data</code> property is a <code>FileEntry</code>.
  This is really cool because now you have a direct reference back to the physical
  file on the disk,
  and you can write data back to it.
</p>

<pre>
chrome.app.runtime.onLaunched(function(intent) {
  // App Launched
  var data = intent.data;
  if(data instanceof FileEntry) {
    data.createWriter(function(writer) {
      writer.onwriteend = function(e) {
        console.log('Write completed.');
      };

      writer.onerror = function(e) {
        console.log('Write failed: ' + e.toString());
      };

      // Create a new Blob and write it to log.txt.
      var blob = new Blob(['Lorem Ipsum'], {type: 'text/plain'});
      writer.write(blob);
    });
  }
});
</pre>

<h2 id="return">Returning data to calling application</h2>
<p>
Lots of applications want to cooperate
with the app that invoked them.
It's easy to send data back to the calling client
using <code>intent.postResult</code>:
</p>

<pre>
chrome.app.runtime.onLaunched(function(intent) {
  // App Launched
  console.log(intent.action);
  console.log(intent.type);
  var data = intent.data;
  // Do something with the data;

  intent.postResult(newData);
});
</pre>

<h2 id="localize">Localizing your app title</h2>

<p>
If your application or extension is localized
as per the guidelines in
<a href="i18n.html">Internationalization (i18n)</a>,
you can localize the title of your intent in the picker
using the exact same infrastructure:
</p>

<pre>
"intents": {
 "http://webintents.org/edit" : [{
   "title" : "__MSG_intent_title__",
   "type" : ["image/*"],
   "disposition" : "inline"
 }]
}
</pre>

<h2 id="invoke">Invoking an action</h2>
<p>
If your application needs to be able
to use the functionality of another application,
it can simply ask the browser for it.
To ask for an application that supports image editing,
it's as simple as:
</p>

<pre>
var intent = new WebKitIntent("http://webintents.org/edit", "image/png", "dataUri://");

window.navigator.webkitStartActivity(intent, function(data) {
// The data from the remote application is returned here.
});
</pre>

<h2 id="errors">Handling Errors and Exceptions</h2>
<p>
   If your service application needs to signal to the client application
   that an unrecoverable error has occurred,
   then your application will need
   to call <code>postError</code> on the intent object.
   This will signal to the client’s onError callback
   that something has gone wrong.
</p>

<h3 id="client">Client</h3>

<pre>
var intent = new WebKitIntent("http://webintents.org/edit", "image/png", "dataUri://");

var onSuccess = function(data) {};
var onError = function() {};

window.navigator.webkitStartActivity(intent, onSuccess, onError);
</pre>

<h3 id="service">Service</h3>
<pre>
chrome.app.runtime.onLaunched(function(intent) {
  // App Launched
  console.log(intent.action);
  console.log(intent.type);
  var data = intent.data;
  // Do something with the data;

  intent.postResult(newData);
});
</pre>

<p class="backtotop"><a href="#top">Back to top</a></p>
<p class="backtotop"><a href="#top"><!--@Back to top-->回到顶部</a></p>
      </div>
    </div>
  </body>
  <script>
    window.bootstrap = {
      api_names: [{"name":"alarms"},{"name":"app.runtime"},{"name":"app.window"},{"name":"bluetooth"},{"name":"commands"},{"name":"contextMenus"},{"name":"events"},{"name":"fileSystem"},{"name":"i18n"},{"name":"idle"},{"name":"mediaGalleries"},{"name":"permissions"},{"name":"pushMessaging"},{"name":"runtime"},{"name":"serial"},{"name":"socket"},{"name":"storage"},{"name":"tts"},{"name":"types"},{"name":"usb"},{"last":true,"name":"webstore"}].concat(
          [{"name":"experimental.app"},{"name":"experimental.identity"},{"name":"experimental.mediaGalleries"},{"name":"experimental.record"},{"name":"experimental.systemInfo.cpu"},{"name":"experimental.systemInfo.display"},{"name":"experimental.systemInfo.memory"},{"last":true,"name":"experimental.systemInfo.storage"}]),
      branchInfo: {"channels":[{"path":"stable","name":"Stable"},{"path":"dev","name":"Dev"},{"path":"beta","name":"Beta"},{"path":"trunk","name":"Trunk"}],"current":"trunk","showWarning":false}
    };
  </script>
  <div id="gc-footer">
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        该页面翻译自
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        与
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>。除非特别<a href="https://code.google.com/policies.html#restrictions">说明</a>，该页面的内容遵循
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>，代码示例遵循
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>。
      </p>
      <p>
        <!--@©2012 Google-->
      </p>
      <script src="/trunk/static/js/branch.js" type="text/javascript"></script>
      <script src="/trunk/static/js/sidebar.js" type="text/javascript"></script>
      <script src="/trunk/static/js/prettify.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++)
            preElements[i].classList.add('prettyprint');
          prettyPrint();
        })();
      </script>
      <script src="https://www.google-analytics.com/urchin.js" type="text/javascript"></script>
      <script src="https://www.google-analytics.com/ga.js" type="text/javascript"></script>
      <script type="text/javascript">
        // chrome doc tracking
        try {
          var engdocs = _gat._getTracker("YT-10763712-2");
          engdocs._trackPageview();
        } catch(err) {}
        // code.google.com site-wide tracking
        try {
          _uacct="UA-18071-1";
          _uanchor=1;
          _uff=0;
          urchinTracker();
        }
        catch(e) {/* urchinTracker not available. */}
      </script>
      <script>
        (function() {
          var cx = '002967670403910741006:61_cvzfqtno';
          var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
          gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
        })();
      </script>
  
    </div>
  </div>
</html>

